# ============================================================
# analysis_metric_schema.yaml (Pydantic uyumlu sürüm)
# %100 uyumlu sürüm: analysis_schema_manager.py + BaseModuleConfig
# ============================================================

meta:
  source: Binance
  version: "2025.1"
  last_updated: "2025-10-10"
  maintainer: "ysf-bot-framework"
  schema_version: 1.2
  description: "Binance private REST API endpoints for trading, balance, risk, and portfolio management."

modules:

  - name: "trend_momentum_ta"
    file: "trend_moment.py"
    config: "c_trend.py"
    command: "/trend"
    command_aliases: ["/t"]
    api_type: "spot_public"
    endpoints:
      - "/api/v3/klines"
      - "/api/v3/ticker/24hr"
      - "/api/v3/avgPrice"
      - "/fapi/v1/continuousKlines"
    methods: ["GET"]
    job_type: "CPU-bound"
    parallel_mode: "batch"
    classical_metrics:
      - EMA
      - RSI
      - MACD
      - Bollinger Bands
      - ATR
      - ADX
    professional_metrics:
      - { name: "Kalman_Filter_Trend", priority: "*" }
      - { name: "Z_Score_Normalization", priority: "*" }
      - { name: "Wavelet_Transform", priority: "**" }
      - { name: "Hilbert_Transform_Slope", priority: "**" }
      - { name: "Fractal_Dimension_Index_FDI", priority: "***" }
    composite_metrics:
      - "0.25*MACD_Histogram + 0.20*RSI + 0.20*EMA_21 + 0.15*EMA_9 + 0.10*EMA_50 + 0.10*Kalman_Trend"
    objective: "Fiyat yönü & momentum gücü"
    output_type: "Trend Score (0–1)"
    description: "Spot ve futures trend uyumunu ölçer; momentum gücü skorunu üretir."
    lifecycle: "development"
    dependencies: []
    version: "2025.1"
    maintainer: "ysf"

  - name: "piyasa_rejimi_volatilite_yapi"
    file: "volat_regime.py"
    config: "c_regime.py"
    command: "/regime"
    command_aliases: ["/rg"]
    api_type: "spot_futures_public"
    endpoints:
      - "/api/v3/klines"
      - "/fapi/v1/markPrice"
      - "/fapi/v1/fundingRate"
      - "/fapi/v1/premiumIndex"
      - "/fapi/v1/indexPriceKlines"
    methods: ["GET"]
    job_type: "CPU-bound"
    parallel_mode: "batch"
    classical_metrics:
      - Historical_Volatility
      - ATR
      - Bollinger_Width
      - Variance_Ratio_Test
      - Range_Expansion_Index
    professional_metrics:
      - { name: "GARCH_1_1", priority: "*" }
      - { name: "Entropy_Index", priority: "*" }
      - { name: "Hurst_Exponent", priority: "**" }
      - { name: "Regime_Switching_Model", priority: "***" }
    composite_metrics:
      - "0.5*Entropy_Index + 0.3*Hurst_Exponent + 0.2*GARCH_Vol"
    objective: "Trend / Range modu ayrımı"
    output_type: "Regime Label (Trend, Range)"
    description: "Volatilite yapısını, implied-realized farklarını ve rejim geçişlerini sınıflandırır."
    lifecycle: "development"
    dependencies: []
    version: "2025.1"
    maintainer: "ysf"

  - name: "derivatives_sentiment"
    file: "deriv_sentim.py"
    config: "c_sentim.py"
    command: "/sentiment"
    command_aliases: ["/s"]
    api_type: "futures_public"
    endpoints:
      - "/fapi/v1/fundingRate"
      - "/fapi/v1/openInterestHist"
      - "/fapi/v1/longShortRatio"
      - "/fapi/v1/liquidationOrders"
      - "/fapi/v1/takerlongshortRatio"
    methods: ["GET"]
    job_type: "I/O-bound"
    parallel_mode: "async"
    classical_metrics:
      - Funding_Rate
      - Open_Interest_OI
      - Long_Short_Ratio
      - OI_Change_Rate
      - Funding_Rate_Skew
      - Volume_Imbalance_Index
    professional_metrics:
      - { name: "Liquidation_Heatmap", priority: "*" }
      - { name: "OI_Delta_Divergence", priority: "**" }
      - { name: "Volatility_Skew", priority: "**" }
      - { name: "Gamma_Exposure", priority: "***" }
    composite_metrics:
      - "0.5*FundingRate + 0.3*OI_Change + 0.2*LS_Ratio"
    objective: "Trader positioning & sentiment eğilimi"
    output_type: "Sentiment Score (-1→1)"
    description: "Pozisyon, fonlama ve likidasyon verilerinden genel piyasa eğilimini belirler."
    lifecycle: "development"
    dependencies: []
    version: "2025.1"
    maintainer: "ysf"

  - name: "order_flow_microstructure"
    file: "order_micros.py"
    config: "c_flow.py"
    command: "/flow"
    command_aliases: ["/f"]
    api_type: "futures_public"
    endpoints:
      - "/fapi/v1/depth"
      - "/fapi/v1/trades"
      - "/fapi/v1/ticker/bookTicker"
    methods: ["GET"]
    job_type: "Stream + CPU"
    parallel_mode: "stream"
    classical_metrics:
      - Orderbook_Imbalance
      - Spread
      - Market_Buy_Sell_Pressure
      - Trade_Aggression_Ratio
      - Slippage
      - Depth_Elasticity
    professional_metrics:
      - { name: "CVD_Cumulative_Volume_Delta", priority: "*" }
      - { name: "Order_Flow_Imbalance_Index_OFI", priority: "**" }
      - { name: "Taker_Dominance_Ratio", priority: "**" }
      - { name: "Liquidity_Density_Map", priority: "***" }
    composite_metrics:
      - "0.5*CVD + 0.3*OFI + 0.2*Taker_Dominance"
    objective: "Anlık yön & likidite baskısı"
    output_type: "Liquidity Pressure Score (0–1)"
    description: "Orderbook ve işlem akışından kısa vadeli yön baskısını çıkarır."
    lifecycle: "development"
    dependencies: []
    version: "2025.1"
    maintainer: "ysf"

  - name: "correlation_lead_lag"
    file: "corr_lead.py"
    config: "c_corr.py"
    command: "/corr"
    command_aliases: ["/c"]
    api_type: "spot_futures_public"
    endpoints:
      - "/api/v3/klines_multi_symbol"
      - "/fapi/v1/markPriceKlines"
      - "/api/v3/ticker/price"
    methods: ["GET"]
    job_type: "CPU + I/O Mixed"
    parallel_mode: "batch"
    classical_metrics:
      - Pearson_Corr
      - Beta
      - Rolling_Covariance
      - Partial_Correlation
      - Rolling_Lead_Lag_Delta
    professional_metrics:
      - { name: "Granger_Causality_Test", priority: "*" }
      - { name: "Dynamic_Time_Warping_DTW", priority: "*" }
      - { name: "Canonical_Correlation", priority: "**" }
      - { name: "Vector_AutoReg_VAR", priority: "***" }
    composite_metrics:
      - "0.4*Granger + 0.3*DTW + 0.3*VAR"
    objective: "Coin’ler arası liderlik & yön takibi"
    output_type: "Correlation Lead-Lag Matrix"
    description: "Farklı coinler arasındaki yön bağımlılıklarını ve liderlik etkilerini analiz eder."
    lifecycle: "development"
    dependencies: []
    version: "2025.1"
    maintainer: "ysf"

  - name: "on_chain_macro"
    file: "onchain.py"
    config: "c_macro.py"
    command: "/macro"
    command_aliases: ["/ma"]
    api_type: "external_binance_hybrid"
    endpoints:
      - "/api/v3/klines"
      - "/fapi/v1/fundingRate"
      - "Glassnode"
      - "Coinglass"
    methods: ["GET"]
    job_type: "I/O-bound"
    parallel_mode: "async"
    classical_metrics:
      - Stablecoin_Flow
      - CEX_Inflow_Outflow
      - ETF_Net_Flow
      - Exchange_Net_Position_Change
      - Realized_Cap
      - NUPL
    professional_metrics:
      - { name: "Net_Realized_Profit_Loss", priority: "*" }
      - { name: "Exchange_Whale_Ratio", priority: "*" }
      - { name: "MVRV_Z_Score", priority: "**" }
      - { name: "SOPR", priority: "***" }
    composite_metrics:
      - "0.6*ETF_Flow + 0.4*MacroRiskOn"
    objective: "Zincir üstü likidite & makro eğilim"
    output_type: "Macro Score (0–1)"
    description: "Binance funding + zincir üstü akış verilerini birleştirerek makro likidite durumu üretir."
    lifecycle: "development"
    dependencies: []
    version: "2025.1"
    maintainer: "ysf"

  - name: "risk_exposure_management"
    file: "risk_expos.py"
    config: "c_risk.py"
    command: "/risk"
    command_aliases: ["/r"]
    api_type: "spot_futures_public"
    endpoints:
      - "/fapi/v1/liquidationOrders"
      - "/fapi/v1/premiumIndex"
      - "/api/v3/klines"
      - "/fapi/v1/positionRisk"
    methods: ["GET"]
    job_type: "CPU-bound"
    parallel_mode: "batch"
    classical_metrics:
      - ATR_Stop
      - Liquidation_Zones
      - Max_Drawdown
      - Volatility_Targeting
      - Position_Leverage_Ratio
    professional_metrics:
      - { name: "Value_at_Risk_VaR", priority: "*" }
      - { name: "Expected_Shortfall_CVaR", priority: "*" }
      - { name: "Sharpe_Sortino_Dynamic", priority: "**" }
      - { name: "ATR_based_Adaptive_Stop", priority: "***" }
    composite_metrics:
      - "0.4*VaR + 0.3*CVaR + 0.3*Sharpe_Dynamic"
    objective: "Risk kontrolü & sinyal güvenliği"
    output_type: "Risk Score (0–1)"
    description: "Kaldıraç, volatilite ve zarar limitlerini dinamik risk skoru olarak hesaplar."
    lifecycle: "development"
    dependencies: []
    version: "2025.1"
    maintainer: "ysf"

  - name: "market_micro_alpha"
    file: "microalpha.py"
    config: "c_micro.py"
    command: "/micro"
    command_aliases: ["/mi"]
    api_type: "futures_public_real_time"
    endpoints:
      - "/fapi/v1/depth"
      - "/fapi/v1/trades"
      - "WebSocket_ws_symbol_trade"
      - "WebSocket_ws_symbol_depth_100ms"
    methods: ["GET", "WebSocket"]
    job_type: "async"
    parallel_mode: "stream"
    classical_metrics:
      - Tick_Volume
      - Spread
      - Bid_Ask_Imbalance
      - Trade_Direction_Ratio
      - Microprice
      - Quote_Stability_Index
    professional_metrics:
      - { name: "CVD_Cumulative_Volume_Delta", priority: "*" }
      - { name: "Order_Flow_Imbalance_Index_OFI", priority: "*" }
      - { name: "Microprice_Deviation", priority: "*" }
      - { name: "Market_Impact_Model_Kyle_Lambda", priority: "**" }
      - { name: "Latency_Adjusted_Flow_Ratio", priority: "**" }
      - { name: "High_Frequency_Z_score", priority: "***" }
    composite_metrics:
      - "0.4*CVD + 0.3*OFI + 0.2*Microprice + 0.1*Kyle"
    objective: "Gerçek zamanlı mikro-yapı yönü ve alpha faktörü üretmek"
    output_type: "Micro Alpha Score (0–1)"
    description: "Tick düzeyinde işlem ve likidite yapısından yönsel alpha faktörleri hesaplar."
    lifecycle: "development"
    dependencies: []
    version: "2025.1"
    maintainer: "ysf"

  - name: "portfolio_optimization_allocation"
    file: "port_alloc.py"
    config: "c_portalloc.py"
    command: "/allocate"
    command_aliases: ["/al"]
    api_type: "private"
    endpoints:
      - "/api/v3/account"
      - "/fapi/v2/balance"
      - "/fapi/v2/account"
      - "/fapi/v2/positionRisk"
      - "/api/v3/klines"
    methods: ["GET"]
    job_type: "CPU-bound"
    parallel_mode: "batch"
    classical_metrics:
      - Sharpe_Ratio
      - Correlation_Matrix
      - Value_at_Risk_VaR
      - Conditional_Beta
      - Sortino_Ratio
      - Drawdown_Correlation
    professional_metrics:
      - { name: "Black_Litterman_Model", priority: "*" }
      - { name: "Hierarchical_Risk_Parity_HRP", priority: "**" }
      - { name: "Risk_Parity", priority: "***" }
    composite_metrics:
      - "0.4*Sharpe + 0.3*Sortino + 0.3*HRP_Weight_Stability"
    objective: "Dinamik portföy optimizasyonu ve risk uyumlu varlık tahsisi"
    output_type: "Allocation Weights"
    description: "Portföy volatilitesi, kovaryans ve korelasyon bazlı optimal dağılım hesaplar."
    lifecycle: "development"
    dependencies: []
    version: "2025.1"
    maintainer: "ysf"

  - name: "regime_change_detection_anomaly"
    file: "regime_anomal.py"
    command: "/redet"
    command_aliases: ["/rd"]
    api_type: "spot_futures_public"
    endpoints:
      - "/api/v3/klines"
      - "/fapi/v1/markPrice"
      - "/fapi/v1/openInterestHist"
      - "/fapi/v1/fundingRate"
    methods: ["GET"]
    job_type: "async"
    parallel_mode: "event"
    classical_metrics:
      - Z_Score
      - Rolling_Mean_Std
      - Rolling_Skewness_Kurtosis
      - Cumulative_Return_Deviation
    professional_metrics:
      - { name: "Changepoint_Detection_CUSUM", priority: "*" }
      - { name: "Isolation_Forest", priority: "**" }
      - { name: "Spectral_Residual", priority: "***" }
    composite_metrics:
      - "0.5*CUSUM + 0.3*IsolationForest + 0.2*SpectralResidual"
    objective: "Ani rejim değişimlerini ve piyasa anomalilerini tespit etmek"
    output_type: "Anomaly Score (0–1)"
    description: "Volatilite, OI ve funding değişimlerine göre rejim dönüşü ve anomali tespit eder."
    lifecycle: "development"
    dependencies: []
    version: "2025.1"
    maintainer: "ysf"
